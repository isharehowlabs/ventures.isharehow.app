(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76733,(e,r,t)=>{"use strict";var a=e.r(78509);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e.r(21506)),o=e.r(91398);t.default=(0,i.default)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},96084,(e,r,t)=>{"use strict";var a=e.r(78509);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e.r(21506)),o=e.r(91398);t.default=(0,i.default)((0,o.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email")},12028,(e,r,t)=>{"use strict";var a=e.r(78509);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e.r(21506)),o=e.r(91398);t.default=(0,i.default)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"}),"AccountCircle")},75449,e=>{"use strict";var r=e.i(91398),t=e.i(17563),a=e.i(56119),i=e.i(77882),o=e.i(72141),n=e.i(86779),s=e.i(17803),l=e.i(16135),c=e.i(21627),d=e.i(62999),h=e.i(64056),p=e.i(21432),x=e.i(43905),m=e.i(96084),u=e.i(12028),y=e.i(40258),f=e.i(33446),g=e.i(76733),b=e.i(71817),j=e.i(12057),v=e.i(9122),T=e.i(69945),S=e.i(5877),w=e.i(3828),P=e.i(91788),k=e.i(1645);function B(){let{user:e,logout:T}=(0,S.useAuth)(),B=(0,w.useRouter)(),[C,M]=(0,P.useState)(null),[A,D]=(0,P.useState)(!0),[I,U]=(0,P.useState)(null),[F,$]=(0,P.useState)(!1),[E,W]=(0,P.useState)(""),[_,z]=(0,P.useState)(!1),[N,L]=(0,P.useState)(!1);(0,P.useEffect)(()=>{let r=async()=>{try{let e=(0,k.getBackendUrl)();console.log("[Profile] Fetching profile from:",`${e}/api/profile`);let r=await fetch(`${e}/api/profile`,{credentials:"include"});if(console.log("[Profile] Response status:",r.status),r.ok){let e=await r.json();console.log("[Profile] Profile data received:",e),M(e),U(null),D(!1)}else{let e=`HTTP ${r.status}`;try{let t=await r.json();e=t.error||t.message||e,console.error("[Profile] Failed to fetch profile:",r.status,t),404===r.status?(console.log("[Profile] User not found in profile endpoint, using authUser data"),U(null),M(null)):U(e)}catch(t){let e=await r.text();console.error("[Profile] Failed to fetch profile (non-JSON response):",r.status,e.substring(0,200)),404===r.status?U(null):U(`Server error: ${r.status}`)}D(!1)}}catch(e){console.error("[Profile] Error fetching profile:",e),U(e.message||"Failed to load profile"),D(!1)}};e?r():D(!1)},[e]),(0,P.useEffect)(()=>{C?.email?W(C.email):e?.email&&W(e.email)},[C,e]);let R=async()=>{if(!E.trim()||!E.includes("@"))return void alert("Please enter a valid email address");if(!e)return void alert("You must be logged in to update your email");z(!0);try{let r=(0,k.getBackendUrl)();console.log("Updating email:",E.trim()),console.log("Backend URL:",r),console.log("User authenticated:",!!e);let t=await fetch(`${r}/api/profile`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:E.trim()})});if(console.log("Response status:",t.status),console.log("Response headers:",Object.fromEntries(t.headers.entries())),t.ok){let e=await t.json();console.log("Updated profile:",e),M(e),$(!1),alert("Email updated successfully!")}else{let e="Unknown error";try{let r=await t.json();e=r.error||r.message||`HTTP ${t.status}`,console.error("Server error:",r)}catch(r){console.error("Failed to parse error response:",r),e=`HTTP ${t.status}: ${t.statusText}`}alert(`Failed to update email: ${e}`)}}catch(e){console.error("Network error updating email:",e),alert(`Network error: ${e.message||"Failed to connect to server. Please check your connection and try again."}`)}finally{z(!1)}},O=async()=>{await T(),B.push("/")},H=async()=>{L(!0);try{let e=(0,k.getBackendUrl)(),r=await fetch(`${e}/api/auth/verify-patreon`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(r.ok){await r.json();let t=await fetch(`${e}/api/profile`,{credentials:"include"});if(t.ok){let e=await t.json();M(e)}alert("Membership status updated successfully!")}else{let e=await r.json();e.needsConnection?alert("Please connect your Patreon account first to verify membership status."):alert(`Failed to verify membership: ${e.error||e.message||"Unknown error"}`)}}catch(e){console.error("Error verifying membership:",e),alert(`Error: ${e.message||"Failed to verify membership status"}`)}finally{L(!1)}};if(!e)return(0,r.jsx)(v.default,{active:"profile",children:(0,r.jsx)(t.Box,{sx:{p:4,textAlign:"center"},children:(0,r.jsx)(d.Alert,{severity:"info",children:"Please log in to view your profile."})})});if(A)return(0,r.jsx)(v.default,{active:"profile",children:(0,r.jsx)(t.Box,{sx:{p:4,textAlign:"center"},children:(0,r.jsx)(a.Typography,{children:"Loading profile..."})})});if(I&&!e)return(0,r.jsx)(v.default,{active:"profile",children:(0,r.jsxs)(t.Box,{sx:{p:4,textAlign:"center"},children:[(0,r.jsx)(d.Alert,{severity:"error",sx:{mb:2},children:I}),(0,r.jsx)(c.Button,{variant:"contained",onClick:()=>B.push("/"),children:"Go Home"})]})});let V={...e,...C||{},id:C?.id||e?.id,patreonId:C?.patreonId||e?.patreonId,createdAt:C?.createdAt||e?.createdAt,email:C?.email||e?.email,name:C?.name||e?.name,avatar:C?.avatar||C?.avatarUrl||e?.avatar,isPaidMember:C?.isPaidMember??e?.isPaidMember,patreonConnected:C?.patreonConnected??e?.patreonConnected,isTeamMember:C?.isTeamMember??e?.isTeamMember};return(0,r.jsx)(v.default,{active:"profile",children:(0,r.jsxs)(t.Box,{sx:{maxWidth:800,mx:"auto"},children:[I&&e&&(0,r.jsxs)(d.Alert,{severity:"warning",sx:{mb:3},children:[I," - Showing limited profile information from authentication data."]}),(0,r.jsx)(a.Typography,{variant:"h4",sx:{fontWeight:700,mb:4,background:"linear-gradient(45deg, #9146FF, #ff6b6b, #4ecdc4)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Profile"}),(0,r.jsxs)(i.Paper,{elevation:2,sx:{p:4,mb:3},children:[(0,r.jsxs)(n.Stack,{direction:"row",spacing:3,alignItems:"center",sx:{mb:4},children:[(0,r.jsx)(o.Avatar,{src:V.avatar,sx:{width:100,height:100,bgcolor:"primary.main",fontSize:"2.5rem"},children:V.name?.charAt(0).toUpperCase()||(0,r.jsx)(u.default,{})}),(0,r.jsxs)(t.Box,{sx:{flex:1},children:[(0,r.jsx)(a.Typography,{variant:"h5",sx:{fontWeight:600,mb:1},children:V.name||"User"}),F?(0,r.jsxs)(t.Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(h.TextField,{size:"small",type:"email",value:E,onChange:e=>W(e.target.value),placeholder:"Enter your email",disabled:_,sx:{minWidth:200}}),(0,r.jsx)(p.IconButton,{size:"small",onClick:R,disabled:_,color:"primary",children:(0,r.jsx)(b.default,{})}),(0,r.jsx)(p.IconButton,{size:"small",onClick:()=>{$(!1),C?.email?W(C.email):e?.email&&W(e.email)},disabled:_,color:"error",children:(0,r.jsx)(j.default,{})})]}):(0,r.jsxs)(t.Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",children:V.email||"Not provided"}),(0,r.jsx)(p.IconButton,{size:"small",onClick:()=>{$(!0)},children:(0,r.jsx)(g.default,{fontSize:"small"})})]})]}),(0,r.jsx)(c.Button,{variant:"outlined",startIcon:(0,r.jsx)(f.default,{}),onClick:()=>B.push("/settings"),children:"Settings"})]}),(0,r.jsx)(s.Divider,{sx:{my:3}}),(0,r.jsxs)(n.Stack,{spacing:3,children:[(0,r.jsxs)(t.Box,{children:[(0,r.jsxs)(n.Stack,{direction:"row",spacing:2,alignItems:"center",sx:{mb:1},children:[(0,r.jsx)(x.default,{color:"action"}),(0,r.jsx)(a.Typography,{variant:"subtitle2",color:"text.secondary",sx:{textTransform:"uppercase",letterSpacing:1},children:"Account Information"})]}),(0,r.jsx)(t.Box,{sx:{pl:5},children:(0,r.jsxs)(n.Stack,{spacing:2,children:[(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"User ID"}),(0,r.jsx)(a.Typography,{variant:"body1",children:V.id||"Not available"})]}),(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Patreon ID"}),(0,r.jsx)(a.Typography,{variant:"body1",children:V.patreonId||"Not connected"})]}),(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Member Since"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:500},children:V.createdAt?new Date(V.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"Not available"})]}),(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Role"}),(0,r.jsxs)(n.Stack,{direction:"row",spacing:1,alignItems:"center",children:[V.isTeamMember&&(0,r.jsx)(l.Chip,{label:"Team Member",color:"secondary",variant:"filled",size:"small"}),(0,r.jsx)(l.Chip,{label:"56776112"===V.patreonId?"Super Admin":V.isTeamMember?"Staff":"Community Member",color:"56776112"===V.patreonId?"error":V.isTeamMember?"warning":"primary",variant:"56776112"===V.patreonId||V.isTeamMember?"filled":"outlined",size:"small"})]})]})]})})]}),(0,r.jsx)(s.Divider,{}),(0,r.jsxs)(t.Box,{children:[(0,r.jsxs)(n.Stack,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[(0,r.jsx)(m.default,{color:"action"}),(0,r.jsx)(a.Typography,{variant:"h6",sx:{fontWeight:600},children:"Membership Information"})]}),(0,r.jsx)(t.Box,{sx:{pl:5},children:(0,r.jsxs)(n.Stack,{spacing:2,children:[(0,r.jsxs)(t.Box,{children:[(0,r.jsxs)(n.Stack,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",sx:{mb:1},children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",children:"Membership Status"}),V.patreonConnected&&(0,r.jsx)(c.Button,{variant:"outlined",size:"small",onClick:H,disabled:N,sx:{textTransform:"none"},children:N?"Verifying...":"Refresh Status"})]}),(0,r.jsxs)(n.Stack,{direction:"row",spacing:1,alignItems:"center",children:[V.isTeamMember&&(0,r.jsx)(l.Chip,{label:"Team Access",color:"warning",variant:"filled",size:"small"}),(0,r.jsx)(l.Chip,{label:V.isPaidMember?"Active Paid Member":"Free Member",color:V.isPaidMember?"success":"default",size:"small"})]}),V.lastChecked&&(0,r.jsxs)(a.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:["Last checked: ",new Date(V.lastChecked).toLocaleString()]}),!V.patreonConnected&&(0,r.jsxs)(t.Box,{sx:{mt:2},children:[(0,r.jsx)(d.Alert,{severity:"info",sx:{mb:2},children:"Connect your Patreon account to verify membership status automatically."}),(0,r.jsx)(c.Button,{variant:"contained",onClick:()=>{let e=(0,k.getBackendUrl)();window.location.href=`${e}/api/auth/patreon`},sx:{bgcolor:"#FF424D","&:hover":{bgcolor:"#E63946"},textTransform:"none",fontWeight:600},children:"Connect Patreon Account"})]})]}),(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Membership Tier"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:V.membershipTier?500:400},children:V.membershipTier?V.membershipTier.charAt(0).toUpperCase()+V.membershipTier.slice(1):"Not set"})]}),V.membershipAmount&&(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Monthly Support"}),(0,r.jsxs)(a.Typography,{variant:"body1",children:["$",V.membershipAmount.toFixed(2),"/month"]})]}),(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Date Paid"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:V.membershipPaymentDate?500:400},children:V.membershipPaymentDate?new Date(V.membershipPaymentDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):V.isPaidMember?"Payment date not available":"No payment recorded"})]}),V.isPaidMember&&V.membershipRenewalDate&&(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Next Renewal"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:500},children:new Date(V.membershipRenewalDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),V.lifetimeSupportAmount&&(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Lifetime Support"}),(0,r.jsxs)(a.Typography,{variant:"body1",children:["$",V.lifetimeSupportAmount.toFixed(2)]})]}),V.lastChargeDate&&(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Last Charge Date"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:500},children:new Date(V.lastChargeDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),V.pledgeStart&&(0,r.jsxs)(t.Box,{children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Pledge Start"}),(0,r.jsx)(a.Typography,{variant:"body1",sx:{fontWeight:500},children:new Date(V.pledgeStart).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,r.jsxs)(t.Box,{sx:{mt:3,p:2,bgcolor:"primary.light",borderRadius:2},children:[(0,r.jsx)(a.Typography,{variant:"body2",color:"primary.contrastText",sx:{mb:1,fontWeight:500},children:"Support Our Mission"}),(0,r.jsx)(c.Button,{variant:"contained",color:"secondary",href:"https://www.patreon.com/cw/JamelEliYah/membership",target:"_blank",rel:"noopener noreferrer",sx:{textTransform:"none",fontWeight:600,boxShadow:2,"&:hover":{boxShadow:4}},startIcon:(0,r.jsx)(f.default,{}),children:"Increase Monthly Support"})]})]})})]}),(0,r.jsx)(s.Divider,{}),(0,r.jsx)(t.Box,{children:(0,r.jsx)(c.Button,{variant:"outlined",color:"error",startIcon:(0,r.jsx)(y.default,{}),onClick:O,sx:{mt:2},children:"Sign Out"})})]})]})]})})}e.s(["default",0,function(){return(0,r.jsx)(T.default,{children:(0,r.jsx)(B,{})})}])},94188,(e,r,t)=>{let a="/profile";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(75449)]),r.hot&&r.hot.dispose(function(){window.__NEXT_P.push([a])})},48761,e=>{e.v(r=>Promise.all(["static/chunks/fd7c0943d5cd5e09.js"].map(r=>e.l(r))).then(()=>r(93594)))},28805,e=>{e.v(r=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(r=>e.l(r))).then(()=>r(79466)))}]);