(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84579,e=>{"use strict";e.i(96335);var l=e.i(80622),t=e.i(84933),i=e.i(58891),a=e.i(81706),r=e.i(15127),n=e.i(85760),n=n,s=e.i(37114),o=e.i(88795),d=e.i(18420),c=e.i(95262),u=e.i(96861),h=e.i(51480),x=e.i(13740);function p(e){return(0,x.default)("MuiFormControlLabel",e)}let m=(0,h.default)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var b=e.i(10646),f=e.i(44855);let j=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],y=(0,c.default)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,l)=>{let{ownerState:t}=e;return[{[`& .${m.label}`]:l.label},l.root,l[`labelPlacement${(0,d.default)(t.labelPlacement)}`]]}})(({theme:e,ownerState:l})=>(0,t.default)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${m.disabled}`]:{cursor:"default"}},"start"===l.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===l.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===l.labelPlacement&&{flexDirection:"column",marginLeft:16},{[`& .${m.label}`]:{[`&.${m.disabled}`]:{color:(e.vars||e).palette.text.disabled}}})),g=(0,c.default)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,l)=>l.asterisk})(({theme:e})=>({[`&.${m.error}`]:{color:(e.vars||e).palette.error.main}})),v=i.forwardRef(function(e,c){var h,x;let m=(0,u.useDefaultProps)({props:e,name:"MuiFormControlLabel"}),{className:v,componentsProps:C={},control:T,disabled:w,disableTypography:P,label:S,labelPlacement:k="end",required:L,slotProps:B={}}=m,M=(0,l.default)(m,j),z=(0,n.default)(),D=null!=(h=null!=w?w:T.props.disabled)?h:null==z?void 0:z.disabled,$=null!=L?L:T.props.required,A={disabled:D,required:$};["checked","name","onChange","value","inputRef"].forEach(e=>{void 0===T.props[e]&&void 0!==m[e]&&(A[e]=m[e])});let R=(0,b.default)({props:m,muiFormControl:z,states:["error"]}),I=(0,t.default)({},m,{disabled:D,labelPlacement:k,required:$,error:R.error}),F=(e=>{let{classes:l,disabled:t,labelPlacement:i,error:a,required:n}=e,s={root:["root",t&&"disabled",`labelPlacement${(0,d.default)(i)}`,a&&"error",n&&"required"],label:["label",t&&"disabled"],asterisk:["asterisk",a&&"error"]};return(0,r.default)(s,p,l)})(I),_=null!=(x=B.typography)?x:C.typography,N=S;return null==N||N.type===o.default||P||(N=(0,f.jsx)(o.default,(0,t.default)({component:"span"},_,{className:(0,a.default)(F.label,null==_?void 0:_.className),children:N}))),(0,f.jsxs)(y,(0,t.default)({className:(0,a.default)(F.root,v),ownerState:I,ref:c},M,{children:[i.cloneElement(T,A),$?(0,f.jsxs)(s.default,{display:"block",children:[N,(0,f.jsxs)(g,{ownerState:I,"aria-hidden":!0,className:F.asterisk,children:[" ","*"]})]}):N]}))});e.s(["FormControlLabel",0,v],84579)},94009,(e,l,t)=>{"use strict";var i=e.r(91074);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(e.r(64800)),r=e.r(44855);t.default=(0,a.default)((0,r.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"Payment")},90669,(e,l,t)=>{"use strict";var i=e.r(91074);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(e.r(64800)),r=e.r(44855);t.default=(0,a.default)((0,r.jsx)("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"}),"Receipt")},31221,e=>{"use strict";var l=e.i(44855),t=e.i(58891),i=e.i(74614),a=e.i(72204),r=e.i(15915),n=e.i(65790),s=e.i(54704),o=e.i(45162),d=e.i(3430),c=e.i(75557),u=e.i(15708),h=e.i(1051),x=e.i(86012),p=e.i(33948),m=e.i(18295),b=e.i(92279),f=e.i(47379),j=e.i(92378),y=e.i(84579),g=e.i(94367),v=e.i(87225),C=e.i(33932),T=e.i(63104),w=e.i(7656),P=e.i(50723),S=e.i(9109),k=e.i(37025),L=e.i(42281),B=e.i(50333),M=e.i(21089),z=e.i(59129),D=e.i(73013),D=D,$=e.i(98807),A=e.i(32327),R=e.i(54385),I=e.i(89634),F=e.i(94009),_=e.i(90669),N=e.i(45680),W=e.i(34699),H=e.i(95532),E=e.i(94544),U=e.i(24918),q=e.i(20887),V=e.i(21504),Y=e.i(15254),G=e.i(13654);e.s(["default",0,function(){let{user:e}=(0,Y.useAuth)(),[O,X]=(0,t.useState)(!0),[K,J]=(0,t.useState)(null),[Q,Z]=(0,t.useState)([]),[ee,el]=(0,t.useState)([]),[et,ei]=(0,t.useState)(null),[ea,er]=(0,t.useState)(!1),[en,es]=(0,t.useState)(0),[eo,ed]=(0,t.useState)(null),[ec,eu]=(0,t.useState)(null);(0,t.useEffect)(()=>{eh()},[]);let eh=async()=>{X(!0),ei(null);try{let e=(0,G.getBackendUrl)(),l=await fetch(`${e}/api/profile`,{credentials:"include"});if(l.ok){let e=await l.json();ed(e.shopifyCustomerId||null)}let t=await fetch(`${e}/api/shopify/store-url`,{credentials:"include"});if(t.ok){let e=await t.json();eu(e.storeUrl||null)}let i=await fetch(`${e}/api/subscriptions/current`,{credentials:"include"});if(i.ok){let e=await i.json();J(e.subscription||null)}let a=await fetch(`${e}/api/billing/payment-methods`,{credentials:"include"});if(a.ok){let e=await a.json();Z(e.paymentMethods||[])}let r=await fetch(`${e}/api/billing/invoices`,{credentials:"include"});if(r.ok){let e=await r.json();el(e.invoices||[])}}catch(e){console.error("Error fetching billing data:",e),ei("Failed to load billing information")}finally{X(!1)}};return(0,l.jsx)(V.default,{children:(0,l.jsx)(q.default,{active:"billing",children:(0,l.jsx)(i.Box,{sx:{flexGrow:1,p:3,bgcolor:"background.default",minHeight:"100vh"},children:(0,l.jsxs)(a.Container,{maxWidth:"lg",children:[(0,l.jsx)(r.Typography,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Billing & Subscription"}),(0,l.jsx)(r.Typography,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Manage your subscription, payment methods, and billing history"}),et&&(0,l.jsx)(S.Alert,{severity:"error",sx:{mb:3},onClose:()=>ei(null),children:et}),(0,l.jsx)(n.Paper,{sx:{mb:3},children:(0,l.jsxs)(A.Tabs,{value:en,onChange:(e,l)=>es(l),children:[(0,l.jsx)(R.Tab,{label:"Subscription"}),(0,l.jsx)(R.Tab,{label:"Payment Methods"}),(0,l.jsx)(R.Tab,{label:"Billing History"})]})}),O?(0,l.jsx)(i.Box,{sx:{display:"flex",justifyContent:"center",py:8},children:(0,l.jsx)(k.CircularProgress,{})}):(0,l.jsxs)(l.Fragment,{children:[0===en&&(0,l.jsx)(o.Card,{children:(0,l.jsxs)(d.CardContent,{children:[(0,l.jsx)(r.Typography,{variant:"h5",fontWeight:600,gutterBottom:!0,sx:{mb:3},children:"Manage Your Subscription"}),ec?(0,l.jsx)(i.Box,{sx:{width:"100%",height:"800px",borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:(0,l.jsx)("iframe",{src:`${ec}/account`,width:"100%",height:"100%",frameBorder:"0",style:{border:"none",borderRadius:"8px"},title:"Shopify Customer Portal",allow:"payment"})}):(0,l.jsx)(S.Alert,{severity:"info",children:(0,l.jsx)(r.Typography,{variant:"body2",children:"Loading Shopify customer portal..."})})]})}),1===en&&(0,l.jsx)(o.Card,{children:(0,l.jsxs)(d.CardContent,{children:[(0,l.jsxs)(i.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,l.jsx)(r.Typography,{variant:"h6",fontWeight:600,children:"Payment Methods"}),(0,l.jsx)(c.Button,{size:"small",startIcon:(0,l.jsx)(W.default,{}),onClick:()=>er(!0),children:"Add Payment Method"})]}),0===Q.length?(0,l.jsxs)(i.Box,{sx:{textAlign:"center",py:4},children:[(0,l.jsx)(F.default,{sx:{fontSize:48,color:"text.secondary",mb:2}}),(0,l.jsx)(r.Typography,{variant:"body2",color:"text.secondary",children:"No payment methods on file"})]}):(0,l.jsx)(L.List,{children:Q.map(e=>(0,l.jsxs)(B.ListItem,{sx:{border:"1px solid",borderColor:"divider",borderRadius:2,mb:1},children:[(0,l.jsx)(M.ListItemIcon,{children:(0,l.jsx)(I.default,{})}),(0,l.jsx)(z.ListItemText,{primary:(0,l.jsxs)(i.Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,l.jsx)(r.Typography,{variant:"body1",fontWeight:500,children:e.brand?`${e.brand.toUpperCase()} •••• ${e.last4}`:`•••• ${e.last4}`}),e.isDefault&&(0,l.jsx)(h.Chip,{label:"Default",size:"small",color:"primary"})]}),secondary:e.expMonth&&e.expYear?`Expires ${e.expMonth}/${e.expYear}`:"bank_account"===e.type?"Bank Account":"Card"}),(0,l.jsx)(D.default,{children:(0,l.jsxs)(u.Stack,{direction:"row",spacing:1,children:[(0,l.jsx)($.Tooltip,{title:"Edit",children:(0,l.jsx)(x.IconButton,{size:"small",children:(0,l.jsx)(H.default,{fontSize:"small"})})}),(0,l.jsx)($.Tooltip,{title:"Delete",children:(0,l.jsx)(x.IconButton,{size:"small",color:"error",children:(0,l.jsx)(E.default,{fontSize:"small"})})})]})})]},e.id))})]})}),2===en&&(0,l.jsx)(o.Card,{children:(0,l.jsxs)(d.CardContent,{children:[(0,l.jsxs)(i.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,l.jsx)(r.Typography,{variant:"h6",fontWeight:600,children:"Billing History"}),(0,l.jsx)(x.IconButton,{size:"small",onClick:eh,children:(0,l.jsx)(U.default,{})})]}),0===ee.length?(0,l.jsxs)(i.Box,{sx:{textAlign:"center",py:4},children:[(0,l.jsx)(_.default,{sx:{fontSize:48,color:"text.secondary",mb:2}}),(0,l.jsx)(r.Typography,{variant:"body2",color:"text.secondary",children:"No invoices found"})]}):(0,l.jsx)(T.TableContainer,{children:(0,l.jsxs)(g.Table,{size:"small",children:[(0,l.jsx)(w.TableHead,{children:(0,l.jsxs)(P.TableRow,{children:[(0,l.jsx)(C.TableCell,{children:"Date"}),(0,l.jsx)(C.TableCell,{children:"Amount"}),(0,l.jsx)(C.TableCell,{children:"Status"}),(0,l.jsx)(C.TableCell,{align:"right",children:"Actions"})]})}),(0,l.jsx)(v.TableBody,{children:ee.map(e=>(0,l.jsxs)(P.TableRow,{children:[(0,l.jsx)(C.TableCell,{children:new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),(0,l.jsx)(C.TableCell,{children:((e,l="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:l}).format(e))(e.amount,e.currency)}),(0,l.jsx)(C.TableCell,{children:(0,l.jsx)(h.Chip,{label:e.status,color:(e=>{switch(e){case"active":case"paid":return"success";case"pending":return"info";case"open":return"warning";case"cancelled":case"void":return"error";default:return"default"}})(e.status),size:"small"})}),(0,l.jsx)(C.TableCell,{align:"right",children:(0,l.jsx)(x.IconButton,{size:"small",onClick:()=>{console.log("Download invoice:",e.id)},disabled:!e.invoicePdf,children:(0,l.jsx)(N.default,{fontSize:"small"})})})]},e.id))})]})})]})})]}),(0,l.jsxs)(p.Dialog,{open:ea,onClose:()=>er(!1),maxWidth:"sm",fullWidth:!0,children:[(0,l.jsx)(m.DialogTitle,{children:"Add Payment Method"}),(0,l.jsx)(b.DialogContent,{children:(0,l.jsxs)(u.Stack,{spacing:3,sx:{mt:1},children:[(0,l.jsx)(j.TextField,{fullWidth:!0,label:"Card Number",placeholder:"1234 5678 9012 3456"}),(0,l.jsxs)(s.Grid,{container:!0,spacing:2,children:[(0,l.jsx)(s.Grid,{item:!0,xs:6,children:(0,l.jsx)(j.TextField,{fullWidth:!0,label:"Expiry Date",placeholder:"MM/YY"})}),(0,l.jsx)(s.Grid,{item:!0,xs:6,children:(0,l.jsx)(j.TextField,{fullWidth:!0,label:"CVC",placeholder:"123"})})]}),(0,l.jsx)(j.TextField,{fullWidth:!0,label:"Cardholder Name",placeholder:"John Doe"}),(0,l.jsx)(y.FormControlLabel,{control:(0,l.jsx)("input",{type:"checkbox",defaultChecked:!0}),label:"Set as default payment method"})]})}),(0,l.jsxs)(f.DialogActions,{children:[(0,l.jsx)(c.Button,{onClick:()=>er(!1),children:"Cancel"}),(0,l.jsx)(c.Button,{variant:"contained",onClick:()=>er(!1),children:"Add Payment Method"})]})]})]})})})})}],31221)},19149,(e,l,t)=>{let i="/billing";(window.__NEXT_P=window.__NEXT_P||[]).push([i,()=>e.r(31221)]),l.hot&&l.hot.dispose(function(){window.__NEXT_P.push([i])})},9781,e=>{e.v(l=>Promise.all(["static/chunks/d62b89fe821ade37.js"].map(l=>e.l(l))).then(()=>l(94246)))},90413,e=>{e.v(l=>Promise.all(["static/chunks/1b9991f459e98f67.js"].map(l=>e.l(l))).then(()=>l(18636)))}]);