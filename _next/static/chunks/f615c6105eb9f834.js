(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45162,3430,e=>{"use strict";e.i(96335);var t=e.i(84933),a=e.i(80622),r=e.i(58891),i=e.i(81706),n=e.i(15127),o=e.i(95262),l=e.i(96861),s=e.i(79413),d=e.i(51480),c=e.i(13740);function u(e){return(0,c.default)("MuiCard",e)}(0,d.default)("MuiCard",["root"]);var h=e.i(44855);let f=["className","raised"],p=(0,o.default)(s.default,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),m=r.forwardRef(function(e,r){let o=(0,l.useDefaultProps)({props:e,name:"MuiCard"}),{className:s,raised:d=!1}=o,c=(0,a.default)(o,f),m=(0,t.default)({},o,{raised:d}),g=(e=>{let{classes:t}=e;return(0,n.default)({root:["root"]},u,t)})(m);return(0,h.jsx)(p,(0,t.default)({className:(0,i.default)(g.root,s),elevation:d?8:void 0,ref:r,ownerState:m},c))});function g(e){return(0,c.default)("MuiCardContent",e)}e.s(["Card",0,m],45162),(0,d.default)("MuiCardContent",["root"]);let x=["className","component"],v=(0,o.default)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),y=r.forwardRef(function(e,r){let o=(0,l.useDefaultProps)({props:e,name:"MuiCardContent"}),{className:s,component:d="div"}=o,c=(0,a.default)(o,x),u=(0,t.default)({},o,{component:d}),f=(e=>{let{classes:t}=e;return(0,n.default)({root:["root"]},g,t)})(u);return(0,h.jsx)(v,(0,t.default)({as:d,className:(0,i.default)(f.root,s),ownerState:u,ref:r},c))});e.s(["CardContent",0,y],3430)},27446,e=>{"use strict";e.i(96335);var t=e.i(80622),a=e.i(84933),r=e.i(58891),i=e.i(81706),n=e.i(15127),o=e.i(18420),l=e.i(95262),s=e.i(32869),d=e.i(95403),c=e.i(85760),u=e.i(12396),h=e.i(51480),f=e.i(13740);function p(e){return(0,f.default)("PrivateSwitchBase",e)}(0,h.default)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var m=e.i(44855);let g=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],x=(0,l.default)(u.default,{name:"MuiSwitchBase"})(({ownerState:e})=>(0,a.default)({padding:9,borderRadius:"50%"},"start"===e.edge&&{marginLeft:"small"===e.size?-3:-12},"end"===e.edge&&{marginRight:"small"===e.size?-3:-12})),v=(0,l.default)("input",{name:"MuiSwitchBase",shouldForwardProp:s.rootShouldForwardProp})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),y=r.forwardRef(function(e,r){let{autoFocus:l,checked:s,checkedIcon:u,className:h,defaultChecked:f,disabled:y,disableFocusRipple:k=!1,edge:j=!1,icon:w,id:C,inputProps:b,inputRef:S,name:B,onBlur:F,onChange:T,onFocus:I,readOnly:E,required:P=!1,tabIndex:z,type:M,value:W}=e,$=(0,t.default)(e,g),[R,O]=(0,d.default)({controlled:s,default:!!f,name:"SwitchBase",state:"checked"}),D=(0,c.default)(),A=y;D&&void 0===A&&(A=D.disabled);let H="checkbox"===M||"radio"===M,N=(0,a.default)({},e,{checked:R,disabled:A,disableFocusRipple:k,edge:j}),U=(e=>{let{classes:t,checked:a,disabled:r,edge:i}=e,l={root:["root",a&&"checked",r&&"disabled",i&&`edge${(0,o.default)(i)}`],input:["input"]};return(0,n.default)(l,p,t)})(N);return(0,m.jsxs)(x,(0,a.default)({component:"span",className:(0,i.default)(U.root,h),centerRipple:!0,focusRipple:!k,disabled:A,tabIndex:null,role:void 0,onFocus:e=>{I&&I(e),D&&D.onFocus&&D.onFocus(e)},onBlur:e=>{F&&F(e),D&&D.onBlur&&D.onBlur(e)},ownerState:N,ref:r},$,{children:[(0,m.jsx)(v,(0,a.default)({autoFocus:l,checked:s,defaultChecked:f,className:U.input,disabled:A,id:H?C:void 0,name:B,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;let t=e.target.checked;O(t),T&&T(e,t)},readOnly:E,ref:S,required:P,ownerState:N,tabIndex:z,type:M},"checkbox"===M&&void 0===W?{}:{value:W},b)),R?u:w]}))});e.s(["default",0,y],27446)},37451,e=>{"use strict";e.i(96335);var t=e.i(80622),a=e.i(84933),r=e.i(58891),i=e.i(81706),n=e.i(15127),o=e.i(96163),l=e.i(27446),s=e.i(62731),d=e.i(44855);let c=(0,s.default)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),u=(0,s.default)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),h=(0,s.default)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var f=e.i(18420),p=e.i(96861),m=e.i(95262),g=e.i(32869),x=e.i(51480),v=e.i(13740);function y(e){return(0,v.default)("MuiCheckbox",e)}let k=(0,x.default)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),j=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],w=(0,m.default)(l.default,{shouldForwardProp:e=>(0,g.rootShouldForwardProp)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.indeterminate&&t.indeterminate,t[`size${(0,f.default)(a.size)}`],"default"!==a.color&&t[`color${(0,f.default)(a.color)}`]]}})(({theme:e,ownerState:t})=>(0,a.default)({color:(e.vars||e).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${"default"===t.color?e.vars.palette.action.activeChannel:e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,o.alpha)("default"===t.color?e.palette.action.active:e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==t.color&&{[`&.${k.checked}, &.${k.indeterminate}`]:{color:(e.vars||e).palette[t.color].main},[`&.${k.disabled}`]:{color:(e.vars||e).palette.action.disabled}})),C=(0,d.jsx)(u,{}),b=(0,d.jsx)(c,{}),S=(0,d.jsx)(h,{}),B=r.forwardRef(function(e,o){var l,s;let c=(0,p.useDefaultProps)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=C,color:h="primary",icon:m=b,indeterminate:g=!1,indeterminateIcon:x=S,inputProps:v,size:k="medium",className:B}=c,F=(0,t.default)(c,j),T=g?x:m,I=g?x:u,E=(0,a.default)({},c,{color:h,indeterminate:g,size:k}),P=(e=>{let{classes:t,indeterminate:r,color:i,size:o}=e,l={root:["root",r&&"indeterminate",`color${(0,f.default)(i)}`,`size${(0,f.default)(o)}`]},s=(0,n.default)(l,y,t);return(0,a.default)({},t,s)})(E);return(0,d.jsx)(w,(0,a.default)({type:"checkbox",inputProps:(0,a.default)({"data-indeterminate":g},v),icon:r.cloneElement(T,{fontSize:null!=(l=T.props.fontSize)?l:k}),checkedIcon:r.cloneElement(I,{fontSize:null!=(s=I.props.fontSize)?s:k}),ownerState:E,ref:o,className:(0,i.default)(P.root,B)},F,{classes:P}))});e.s(["Checkbox",0,B],37451)},25972,(e,t,a)=>{"use strict";var r=e.r(91074);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e.r(64800)),n=e.r(44855);a.default=(0,i.default)((0,n.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code")},94556,(e,t,a)=>{"use strict";var r=e.r(91074);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e.r(64800)),n=e.r(44855);a.default=(0,i.default)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonUnchecked")},20012,(e,t,a)=>{"use strict";var r=e.r(91074);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e.r(64800)),n=e.r(44855);a.default=(0,i.default)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M9.5 16.5v-9l7 4.5z"}),"PlayCircle")},16875,(e,t,a)=>{"use strict";var r=e.r(91074);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e.r(64800)),n=e.r(44855);a.default=(0,i.default)((0,n.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"}),"Bookmark")},26482,e=>{"use strict";var t=e.i(58891),a=e.i(13654);function r(){let[e,r]=(0,t.useState)([]),[i,n]=(0,t.useState)([]),[o,l]=(0,t.useState)([]),[s,d]=(0,t.useState)([]),[c,u]=(0,t.useState)([]),[h,f]=(0,t.useState)([]),[p,m]=(0,t.useState)({}),[g,x]=(0,t.useState)(!1),[v,y]=(0,t.useState)(null);return{files:e,components:i,tokens:o,likedComponents:s,savedComponents:c,draftedComponents:h,componentStatuses:p,isLoading:g,error:v,fetchFiles:async()=>{try{x(!0),y(null);let e=(0,a.getBackendUrl)(),t=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/files`,{method:"GET"}),i=await t.json();r(i.projects||[])}catch(e){y(e.message),console.error("Error fetching Figma files:",e)}finally{x(!1)}},fetchFile:async e=>{if(!e||"string"!=typeof e||""===e.trim()||"undefined"===e||"null"===e){let e=Error("Invalid file ID: file ID is required and must be a valid string");throw y(e.message),e}let t=e.trim();try{x(!0),y(null);let e=(0,a.getBackendUrl)(),r=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/file/${t}`,{method:"GET"});return(await r.json()).file}catch(e){throw y(e?.message||"Failed to fetch Figma file"),e}finally{x(!1)}},fetchComponents:async e=>{if(!e||"string"!=typeof e||""===e.trim()||"undefined"===e||"null"===e){let e=Error("Invalid file ID: file ID is required and must be a valid string");throw y(e.message),e}let t=e.trim();try{x(!0),y(null);let e=(0,a.getBackendUrl)(),r=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/file/${t}/components`,{method:"GET"}),i=await r.json();return n(i.components||[]),i.components}catch(e){throw y(e?.message||"Failed to fetch Figma components"),e}finally{x(!1)}},fetchTokens:async e=>{if(!e||"string"!=typeof e||""===e.trim()||"undefined"===e||"null"===e){let e=Error("Invalid file ID: file ID is required and must be a valid string");throw y(e.message),e}let t=e.trim();try{x(!0),y(null);let e=(0,a.getBackendUrl)(),r=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/file/${t}/tokens`,{method:"GET"}),i=await r.json();return l(i.tokens||[]),i.tokens}catch(e){throw y(e?.message||"Failed to fetch Figma tokens"),e}finally{x(!1)}},likeComponent:async(e,t=!0,r)=>{try{x(!0),y(null);let i=(0,a.getBackendUrl)(),n=await (0,a.fetchWithErrorHandling)(`${i}/api/figma/component/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({componentId:e,liked:t,fileId:r})}),o=await n.json();return o.success&&(m(a=>({...a,[e]:{...a[e],liked:t}})),t?d(t=>t.includes(e)?t:[...t,e]):d(t=>t.filter(t=>t!==e))),o}catch(e){throw y(e?.message||"Failed to like component"),e}finally{x(!1)}},saveComponent:async(e,t=!0,r)=>{try{x(!0),y(null);let i=(0,a.getBackendUrl)(),n=await (0,a.fetchWithErrorHandling)(`${i}/api/figma/component/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({componentId:e,saved:t,fileId:r})}),o=await n.json();return o.success&&(m(a=>({...a,[e]:{...a[e],saved:t}})),t?u(t=>t.includes(e)?t:[...t,e]):u(t=>t.filter(t=>t!==e))),o}catch(e){throw y(e?.message||"Failed to save component"),e}finally{x(!1)}},draftComponent:async(e,t=!0,r)=>{try{x(!0),y(null);let i=(0,a.getBackendUrl)(),n=await (0,a.fetchWithErrorHandling)(`${i}/api/figma/component/draft`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({componentId:e,drafted:t,draftData:r})}),o=await n.json();return o.success&&(m(a=>({...a,[e]:{...a[e],drafted:t}})),t?f(t=>t.includes(e)?t:[...t,e]):f(t=>t.filter(t=>t!==e))),o}catch(e){throw y(e?.message||"Failed to draft component"),e}finally{x(!1)}},fetchLikedComponents:async()=>{try{x(!0),y(null);let e=(0,a.getBackendUrl)(),t=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/components/liked`,{method:"GET"}),r=await t.json();return d(r.componentIds||[]),r.componentIds||[]}catch(e){throw y(e?.message||"Failed to fetch liked components"),e}finally{x(!1)}},fetchSavedComponents:async()=>{try{x(!0),y(null);let e=(0,a.getBackendUrl)(),t=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/components/saved`,{method:"GET"}),r=await t.json();return u(r.componentIds||[]),r.componentIds||[]}catch(e){throw y(e?.message||"Failed to fetch saved components"),e}finally{x(!1)}},fetchDraftedComponents:async()=>{try{x(!0),y(null);let e=(0,a.getBackendUrl)(),t=await (0,a.fetchWithErrorHandling)(`${e}/api/figma/components/drafted`,{method:"GET"}),r=await t.json();return f(r.componentIds||[]),r.componentIds||[]}catch(e){throw y(e?.message||"Failed to fetch drafted components"),e}finally{x(!1)}},fetchComponentStatus:async e=>{try{let t=(0,a.getBackendUrl)(),r=await (0,a.fetchWithErrorHandling)(`${t}/api/figma/component/${e}/status`,{method:"GET"}),i=await r.json();return m(t=>({...t,[e]:{liked:i.liked||!1,saved:i.saved||!1,drafted:i.drafted||!1}})),i}catch(e){return console.error("Error fetching component status:",e),{liked:!1,saved:!1,drafted:!1}}},fetchComponentPreferences:async e=>{try{x(!0),y(null);let t=(0,a.getBackendUrl)(),r=e?JSON.stringify({componentIds:e}):void 0,i=await (0,a.fetchWithErrorHandling)(`${t}/api/figma/components/preferences`,{method:e?"POST":"GET",headers:e?{"Content-Type":"application/json"}:void 0,body:r}),n=await i.json();if(n.preferences){m(e=>{let t={...e};return Object.entries(n.preferences).forEach(([e,a])=>{t[e]={liked:a.liked||!1,saved:a.saved||!1,drafted:a.drafted||!1}}),t});let e=Object.entries(n.preferences).filter(([e,t])=>t.liked).map(([e])=>e),t=Object.entries(n.preferences).filter(([e,t])=>t.saved).map(([e])=>e),a=Object.entries(n.preferences).filter(([e,t])=>t.drafted).map(([e])=>e);d(e),u(t),f(a)}return n}catch(e){throw y(e?.message||"Failed to fetch component preferences"),e}finally{x(!1)}}}}e.s(["useFigma",()=>r])},38568,e=>{"use strict";var t=e.i(58891),a=e.i(13654);function r(){let[e,r]=(0,t.useState)([]),[i,n]=(0,t.useState)([]),[o,l]=(0,t.useState)(!1),[s,d]=(0,t.useState)(null),c=async e=>{try{l(!0),d(null);let t=(0,a.getBackendUrl)(),i=new URL(`${t}/api/mcp/code-links`);e&&i.searchParams.append("figmaFileId",e);let n=await fetch(i.toString(),{credentials:"include"});if(!n.ok)throw Error("Failed to fetch code links");let o=await n.json();r(o.links||[])}catch(e){d(e.message)}finally{l(!1)}},u=async()=>{try{l(!0),d(null);let e=(0,a.getBackendUrl)(),t=await fetch(`${e}/api/mcp/tokens`,{credentials:"include"});if(!t.ok)throw Error("Failed to fetch tokens");let r=await t.json();n(r.tokens||[])}catch(e){d(e.message)}finally{l(!1)}};return{links:e,tokens:i,isLoading:o,error:s,linkComponentToCode:async(e,t,r,i)=>{try{l(!0),d(null);let n=(0,a.getBackendUrl)(),o=await fetch(`${n}/api/mcp/figma-to-code`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({figmaComponentId:e,codeFilePath:t,codeComponentName:r,figmaFileId:i})});if(!o.ok)throw Error("Failed to link component");let s=await o.json();return await c(),s}catch(e){throw d(e.message),e}finally{l(!1)}},fetchCodeLinks:c,syncTokens:async e=>{try{l(!0),d(null);let t=(0,a.getBackendUrl)(),r=await fetch(`${t}/api/mcp/sync-tokens`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({tokens:e})});if(!r.ok)throw Error("Failed to sync tokens");let i=await r.json();return await u(),i}catch(e){throw d(e.message),e}finally{l(!1)}},fetchTokens:u,generateCode:async(e,t)=>{try{l(!0),d(null);let r=(0,a.getBackendUrl)(),i=await fetch(`${r}/api/mcp/generate-code`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({componentId:e,language:t})});if(!i.ok)throw Error("Failed to generate code");return await i.json()}catch(e){throw d(e.message),e}finally{l(!1)}}}}e.s(["useMCP",()=>r])},27245,43892,e=>{"use strict";var t=e.i(44855),a=e.i(58891),r=e.i(74614),i=e.i(65790),n=e.i(54704),o=e.i(15915),l=e.i(92378),s=e.i(86012),d=e.i(75557),c=e.i(98807),u=e.i(1051),h=e.i(33948),f=e.i(18295),p=e.i(92279),m=e.i(47379),g=e.i(83161),x=e.i(47617),v=e.i(39972),y=e.i(20161),k=e.i(9109),j=e.i(37025),w=e.i(45162),C=e.i(3430),b=e.i(37451),S=e.i(34699),B=e.i(25972),F=e.i(95532),T=e.i(94544);e.i(72695),e.i(94556),e.i(20012);var I=e.i(99700),E=e.i(27367),P=e.i(16875),z=e.i(24918),M=e.i(13654),W=e.i(75016),$=e.i(9929),R=e.i(15254);let O=null,D=null;try{let t=e.r(26482);O=t.useFigma||t.default?.useFigma}catch(e){console.warn("Figma hook not available:",e)}try{let t=e.r(38568);D=t.useMCP||t.default?.useMCP}catch(e){console.warn("MCP hook not available:",e)}function A(){let{user:e}=(0,R.useAuth)(),{tasks:A,createTask:H,updateTask:N,deleteTask:U,isLoading:L,error:_,authRequired:q,refresh:G,isStale:V}=function(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)(!1),[n,o]=(0,a.useState)(null),[l,s]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(null),m=(0,a.useCallback)(async()=>{try{i(!0),o(null),s(!1);let e=(0,M.getBackendUrl)(),a=await (0,M.fetchWithErrorHandling)(`${e}/api/tasks`,{method:"GET"});if(401===a.status){s(!0),o("Authentication required"),t([]);return}let r=await a.json();t(r.tasks||[]),h(new Date),c(!1)}catch(e){e?.status===401||e?.message?.includes("Authentication required")?(s(!0),o("Authentication required"),t([])):(o(e?.message||"Failed to fetch tasks"),console.error("Error fetching tasks:",e))}finally{i(!1)}},[]),g=(0,a.useCallback)(()=>m(),[m]),x=async(e,t,a,r)=>{try{i(!0),o(null),s(!1);let n=(0,M.getBackendUrl)(),l=await (0,M.fetchWithErrorHandling)(`${n}/api/tasks`,{method:"POST",body:JSON.stringify({title:e,description:t,hyperlinks:a,status:r})});if(401===l.status)throw s(!0),Error("Authentication required");return(await l.json()).task}catch(e){throw(e?.status===401||e?.message?.includes("Authentication required"))&&s(!0),o(e.message),e}finally{i(!1)}},v=async(e,t)=>{try{i(!0),o(null),s(!1);let a=(0,M.getBackendUrl)(),r=await (0,M.fetchWithErrorHandling)(`${a}/api/tasks/${e}`,{method:"PUT",body:JSON.stringify(t)});if(401===r.status)throw s(!0),Error("Authentication required");return(await r.json()).task}catch(e){throw(e?.status===401||e?.message?.includes("Authentication required"))&&s(!0),o(e.message),e}finally{i(!1)}},y=async e=>{try{i(!0),o(null),s(!1);let t=(0,M.getBackendUrl)(),a=await (0,M.fetchWithErrorHandling)(`${t}/api/tasks/${e}`,{method:"DELETE"});if(401===a.status)throw s(!0),Error("Authentication required")}catch(e){throw(e?.status===401||e?.message?.includes("Authentication required"))&&s(!0),o(e.message),e}finally{i(!1)}};return(0,a.useEffect)(()=>{m();let e=(0,W.getSocket)();p(e);let a=()=>{console.log("Socket.io connected for tasks")},r=e=>{console.warn("Socket.io connection error (tasks):",{message:e.message})},i=e=>{console.log("Socket.io disconnected (tasks):",e)};e.on("connect",a),e.on("connect_error",r),e.on("disconnect",i),e.on("task_created",e=>{t(t=>[...t,e]),h(new Date)}),e.on("task_updated",e=>{t(t=>t.map(t=>t.id===e.id?e:t)),h(new Date)}),e.on("task_deleted",e=>{t(t=>t.filter(t=>t.id!==e.id)),h(new Date)}),e.on("auth_restored_ack",()=>{s(!1),m()});let n=setInterval(()=>{u&&Date.now()-u.getTime()>3e5&&c(!0)},6e4);return()=>{e.off("connect",a),e.off("connect_error",r),e.off("disconnect",i),e.off("task_created"),e.off("task_updated"),e.off("task_deleted"),e.off("auth_restored_ack"),clearInterval(n)}},[m,u]),{tasks:e,isLoading:r,error:n,authRequired:l,isStale:d,lastUpdated:u,refresh:g,fetchTasks:m,createTask:x,updateTask:v,deleteTask:y}}(),J=null,K=null;try{O&&(J=O())}catch(e){console.warn("Figma hook not available:",e)}try{D&&(K=D())}catch(e){console.warn("MCP hook not available:",e)}let Q=J?.files||[],X=J?.components||[];J?.tokens;let Y=J?.componentStatuses||{};J?.isLoading;let Z=J?.error||null,ee=J?.fetchFiles||(()=>Promise.resolve()),et=J?.fetchComponents||(()=>Promise.resolve()),ea=J?.likeComponent||(()=>Promise.resolve()),er=J?.saveComponent||(()=>Promise.resolve()),ei=J?.fetchLikedComponents||(()=>Promise.resolve()),en=J?.fetchSavedComponents||(()=>Promise.resolve()),eo=J?.fetchDraftedComponents||(()=>Promise.resolve()),el=J?.fetchComponentStatus||(()=>Promise.resolve());K?.links,K?.tokens;let es=K?.linkComponentToCode||(()=>Promise.resolve()),ed=K?.fetchCodeLinks||(()=>Promise.resolve()),ec=K?.fetchTokens||(()=>Promise.resolve()),[eu,eh]=(0,a.useState)(""),[ef,ep]=(0,a.useState)(!1),[em,eg]=(0,a.useState)("create"),[ex,ev]=(0,a.useState)(null),[ey,ek]=(0,a.useState)(""),[ej,ew]=(0,a.useState)(""),[eC,eb]=(0,a.useState)(""),[eS,eB]=(0,a.useState)("pending"),[eF,eT]=(0,a.useState)(""),[eI,eE]=(0,a.useState)([]),[eP,ez]=(0,a.useState)(!1),[eM,eW]=(0,a.useState)(null),[e$,eR]=(0,a.useState)(!1),[eO,eD]=(0,a.useState)(""),[eA,eH]=(0,a.useState)(""),[eN,eU]=(0,a.useState)(""),[eL,e_]=(0,a.useState)(!1),eq=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=localStorage.getItem("workspace_markdown");e&&eh(e)},[]),(0,a.useEffect)(()=>{""!==eu&&localStorage.setItem("workspace_markdown",eu)},[eu]),(0,a.useEffect)(()=>{(async()=>{if(e&&(e.isEmployee||e.isAdmin)){ez(!0);try{let e=(0,M.getBackendUrl)(),t=await fetch(`${e}/api/creative/support-requests`,{credentials:"include"});if(t.ok){let e=await t.json();eE(e.requests||[])}}catch(e){console.error("Error fetching support requests:",e)}finally{ez(!1)}}})()},[e]),(0,a.useEffect)(()=>{O&&D&&(async()=>{try{await Promise.all([ee(),ed(),ec(),ei(),en(),eo()])}catch(e){console.error("Error loading Figma data:",e)}})()},[]),(0,a.useEffect)(()=>{eM&&O&&(e_(!0),et(eM).then(()=>{X.length>0&&Promise.all(X.map(e=>el(e.key,eM)))}).catch(e=>console.error("Error fetching components:",e)).finally(()=>e_(!1)))},[eM]);let eG=async t=>{let a=A.find(e=>e.id===t);if(!a)return;let r="completed"===a.status?"pending":"completed";try{await N(t,{status:r}),"completed"===r&&(0,$.trackTaskCompleted)(t,e?.userRole||"user","cowork")}catch(e){console.error("Error toggling task:",e)}},eV=async()=>{if(ey.trim())try{let t=eC.split(",").map(e=>e.trim()).filter(e=>e);if("create"===em){let e=await H(ey.trim(),ej.trim(),t,eS);eF&&e?.id&&await N(e.id,{supportRequestId:eF})}else ex&&(await N(ex,{title:ey.trim(),description:ej.trim(),hyperlinks:t,status:eS,supportRequestId:eF||void 0}),"completed"===eS&&(0,$.trackTaskCompleted)(ex,e?.userRole||"user","cowork"));ep(!1)}catch(e){console.error("Error saving task:",e)}},eJ=async e=>{try{await U(e)}catch(e){console.error("Error deleting task:",e)}},eK=async(e,t)=>{t.stopPropagation();let a=Y[e]?.liked||!1;try{await ea(e,!a,eM||void 0)}catch(e){console.error("Error liking component:",e)}},eQ=async(e,t)=>{t.stopPropagation();let a=Y[e]?.saved||!1;try{await er(e,!a,eM||void 0)}catch(e){console.error("Error saving component:",e)}},eX=async()=>{if(eO&&eA)try{await es(eO,eA,eN,eM||""),eR(!1),ed()}catch(e){console.error("Error linking component:",e)}};return(0,t.jsxs)(r.Box,{sx:{width:"100%"},children:[(0,t.jsxs)(n.Grid,{container:!0,spacing:3,children:[(0,t.jsx)(n.Grid,{item:!0,xs:12,lg:6,children:(0,t.jsxs)(i.Paper,{elevation:2,sx:{p:3,height:500},children:[(0,t.jsxs)(r.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsx)(o.Typography,{variant:"h5",fontWeight:700,children:"Collaborative Notes"}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:1},children:[(0,t.jsx)(c.Tooltip,{title:"Copy all",children:(0,t.jsx)(s.IconButton,{onClick:()=>{eq.current?(eq.current.select(),document.execCommand("copy")):navigator.clipboard.writeText(eu)},size:"small",children:(0,t.jsx)(B.default,{})})}),(0,t.jsx)(d.Button,{variant:"outlined",size:"small",onClick:()=>{eh(""),localStorage.removeItem("workspace_markdown")},children:"Clear"})]})]}),(0,t.jsx)(l.TextField,{fullWidth:!0,multiline:!0,rows:15,variant:"outlined",placeholder:"Write your collaborative notes here...",value:eu,onChange:e=>eh(e.target.value),inputRef:eq,sx:{"& .MuiInputBase-root":{height:"100%",alignItems:"flex-start"}}})]})}),(0,t.jsx)(n.Grid,{item:!0,xs:12,lg:6,children:(0,t.jsxs)(i.Paper,{elevation:2,sx:{p:3,height:500,display:"flex",flexDirection:"column"},children:[(0,t.jsxs)(r.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsx)(o.Typography,{variant:"h5",fontWeight:700,children:"Tasks"}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:1},children:[(0,t.jsx)(c.Tooltip,{title:"Refresh",children:(0,t.jsx)(s.IconButton,{onClick:G,size:"small",children:(0,t.jsx)(z.default,{})})}),(0,t.jsx)(d.Button,{variant:"contained",startIcon:(0,t.jsx)(S.default,{}),onClick:()=>{eg("create"),ev(null),ek(""),ew(""),eb(""),eB("pending"),eT(""),ep(!0)},size:"small",children:"Add Task"})]})]}),_&&(0,t.jsx)(k.Alert,{severity:"error",sx:{mb:2},children:_}),V&&(0,t.jsx)(k.Alert,{severity:"info",sx:{mb:2},action:(0,t.jsx)(d.Button,{size:"small",onClick:G,children:"Refresh"}),children:"Tasks may be out of date"}),(0,t.jsxs)(r.Box,{sx:{flexGrow:1,overflow:"auto"},children:[A.map(e=>(0,t.jsx)(w.Card,{sx:{mb:2},elevation:1,children:(0,t.jsx)(C.CardContent,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:(0,t.jsxs)(r.Box,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:[(0,t.jsx)(b.Checkbox,{checked:"completed"===e.status,onChange:()=>eG(e.id),disabled:L,size:"small"}),(0,t.jsxs)(r.Box,{sx:{flexGrow:1,minWidth:0},children:[(0,t.jsx)(o.Typography,{variant:"subtitle1",fontWeight:500,sx:{textDecoration:"completed"===e.status?"line-through":"none"},children:e.title}),e.description&&(0,t.jsx)(o.Typography,{variant:"body2",color:"text.secondary",noWrap:!0,children:e.description}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:.5,mt:.5,flexWrap:"wrap"},children:[(0,t.jsx)(u.Chip,{label:e.status,size:"small",color:(e=>{switch(e){case"completed":return"success";case"in-progress":return"warning";default:return"default"}})(e.status)}),e.hyperlinks&&e.hyperlinks.length>0&&(0,t.jsx)(u.Chip,{icon:(0,t.jsx)(I.default,{}),label:`${e.hyperlinks.length}`,size:"small",variant:"outlined"})]})]}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:.5},children:[(0,t.jsx)(s.IconButton,{size:"small",onClick:()=>{eg("edit"),ev(e.id),ek(e.title),ew(e.description||""),eb(e.hyperlinks.join(", ")),eB(e.status),eT(e.supportRequestId||""),ep(!0)},children:(0,t.jsx)(F.default,{fontSize:"small"})}),(0,t.jsx)(s.IconButton,{size:"small",onClick:()=>eJ(e.id),children:(0,t.jsx)(T.default,{fontSize:"small"})})]})]})})},e.id)),0===A.length&&!L&&(0,t.jsx)(r.Box,{sx:{textAlign:"center",py:4},children:(0,t.jsx)(o.Typography,{variant:"body2",color:"text.secondary",children:"No tasks yet. Add your first task to get started!"})}),L&&(0,t.jsx)(r.Box,{sx:{textAlign:"center",py:4},children:(0,t.jsx)(j.CircularProgress,{size:24})})]})]})}),(0,t.jsx)(n.Grid,{item:!0,xs:12,children:(0,t.jsxs)(i.Paper,{elevation:2,sx:{p:3,height:500,display:"flex",flexDirection:"column"},children:[(0,t.jsxs)(r.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsx)(o.Typography,{variant:"h5",fontWeight:700,children:"Design & Figma"}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:1},children:[(0,t.jsx)(c.Tooltip,{title:"Refresh",children:(0,t.jsx)(s.IconButton,{onClick:()=>{eM?et(eM):ee()},size:"small",children:(0,t.jsx)(z.default,{})})}),(0,t.jsx)(d.Button,{variant:"outlined",size:"small",onClick:()=>eR(!0),disabled:!eM||0===X.length,children:"Link to Code"})]})]}),O&&D?(0,t.jsxs)(r.Box,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[Z&&(0,t.jsx)(k.Alert,{severity:"error",sx:{mb:2},children:Z}),(0,t.jsx)(r.Box,{sx:{mb:2},children:(0,t.jsxs)(g.FormControl,{fullWidth:!0,size:"small",children:[(0,t.jsx)(x.InputLabel,{children:"Select Figma File"}),(0,t.jsxs)(v.Select,{value:eM||"",label:"Select Figma File",onChange:e=>eW(e.target.value),children:[(0,t.jsx)(y.MenuItem,{value:"",children:"-- Select a file --"}),Q.map(e=>(0,t.jsx)(y.MenuItem,{value:e.key,children:e.name},e.key))]})]})}),eM&&(0,t.jsx)(r.Box,{sx:{flexGrow:1,overflow:"auto"},children:eL?(0,t.jsxs)(r.Box,{sx:{textAlign:"center",py:4},children:[(0,t.jsx)(j.CircularProgress,{size:24}),(0,t.jsx)(o.Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Loading components..."})]}):(0,t.jsxs)(n.Grid,{container:!0,spacing:2,children:[X.map(e=>(0,t.jsx)(n.Grid,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,t.jsx)(w.Card,{elevation:1,children:(0,t.jsxs)(C.CardContent,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:[(0,t.jsx)(o.Typography,{variant:"subtitle2",noWrap:!0,fontWeight:500,children:e.name}),(0,t.jsxs)(r.Box,{sx:{display:"flex",gap:.5,mt:1},children:[(0,t.jsx)(s.IconButton,{size:"small",onClick:t=>eK(e.key,t),color:Y[e.key]?.liked?"error":"default",children:(0,t.jsx)(E.default,{fontSize:"small"})}),(0,t.jsx)(s.IconButton,{size:"small",onClick:t=>eQ(e.key,t),color:Y[e.key]?.saved?"primary":"default",children:(0,t.jsx)(P.default,{fontSize:"small"})})]})]})})},e.key)),0===X.length&&(0,t.jsx)(n.Grid,{item:!0,xs:12,children:(0,t.jsx)(o.Typography,{variant:"body2",color:"text.secondary",textAlign:"center",py:4,children:"No components found in this file."})})]})}),!eM&&(0,t.jsx)(r.Box,{sx:{textAlign:"center",py:4},children:(0,t.jsx)(o.Typography,{variant:"body2",color:"text.secondary",children:"Select a Figma file to view components"})})]}):(0,t.jsx)(k.Alert,{severity:"info",children:"Figma integration not available. Check your configuration."})]})})]}),(0,t.jsxs)(h.Dialog,{open:ef,onClose:()=>ep(!1),maxWidth:"sm",fullWidth:!0,children:[(0,t.jsx)(f.DialogTitle,{children:"create"===em?"Add Task":"Edit Task"}),(0,t.jsxs)(p.DialogContent,{children:[(0,t.jsx)(l.TextField,{autoFocus:!0,margin:"dense",label:"Title",fullWidth:!0,variant:"outlined",value:ey,onChange:e=>ek(e.target.value),sx:{mb:2,mt:1}}),(0,t.jsx)(l.TextField,{margin:"dense",label:"Description",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,value:ej,onChange:e=>ew(e.target.value),sx:{mb:2}}),(0,t.jsx)(l.TextField,{margin:"dense",label:"Hyperlinks (comma-separated)",fullWidth:!0,variant:"outlined",value:eC,onChange:e=>eb(e.target.value),placeholder:"https://example.com, https://another.com",sx:{mb:2}}),eP?(0,t.jsx)(j.CircularProgress,{size:24}):eI.length>0&&(0,t.jsxs)(g.FormControl,{fullWidth:!0,margin:"dense",sx:{mb:2},children:[(0,t.jsx)(x.InputLabel,{children:"Link to Support Request (Optional)"}),(0,t.jsxs)(v.Select,{value:eF,label:"Link to Support Request (Optional)",onChange:e=>eT(e.target.value),children:[(0,t.jsx)(y.MenuItem,{value:"",children:"None"}),eI.map(e=>(0,t.jsxs)(y.MenuItem,{value:e.id,children:[e.subject," (",e.status,")"]},e.id))]})]}),(0,t.jsxs)(g.FormControl,{fullWidth:!0,margin:"dense",children:[(0,t.jsx)(x.InputLabel,{children:"Status"}),(0,t.jsxs)(v.Select,{value:eS,label:"Status",onChange:e=>eB(e.target.value),children:[(0,t.jsx)(y.MenuItem,{value:"pending",children:"Pending"}),(0,t.jsx)(y.MenuItem,{value:"in-progress",children:"In Progress"}),(0,t.jsx)(y.MenuItem,{value:"completed",children:"Completed"})]})]})]}),(0,t.jsxs)(m.DialogActions,{children:[(0,t.jsx)(d.Button,{onClick:()=>ep(!1),children:"Cancel"}),(0,t.jsx)(d.Button,{onClick:eV,variant:"contained",disabled:!ey.trim()||L||q,children:"create"===em?"Add":"Save"})]})]}),(0,t.jsxs)(h.Dialog,{open:e$,onClose:()=>eR(!1),maxWidth:"sm",fullWidth:!0,children:[(0,t.jsx)(f.DialogTitle,{children:"Link Figma Component to Code"}),(0,t.jsxs)(p.DialogContent,{children:[(0,t.jsxs)(g.FormControl,{fullWidth:!0,margin:"dense",sx:{mb:2,mt:1},children:[(0,t.jsx)(x.InputLabel,{children:"Figma Component"}),(0,t.jsx)(v.Select,{value:eO,label:"Figma Component",onChange:e=>eD(e.target.value),children:X.map(e=>(0,t.jsx)(y.MenuItem,{value:e.key,children:e.name},e.key))})]}),(0,t.jsx)(l.TextField,{margin:"dense",label:"Code File Path",fullWidth:!0,variant:"outlined",value:eA,onChange:e=>eH(e.target.value),placeholder:"/src/components/Button.tsx",sx:{mb:2}}),(0,t.jsx)(l.TextField,{margin:"dense",label:"Component Name (Optional)",fullWidth:!0,variant:"outlined",value:eN,onChange:e=>eU(e.target.value),placeholder:"Button"})]}),(0,t.jsxs)(m.DialogActions,{children:[(0,t.jsx)(d.Button,{onClick:()=>eR(!1),children:"Cancel"}),(0,t.jsx)(d.Button,{onClick:eX,variant:"contained",disabled:!eO||!eA,children:"Link"})]})]})]})}e.s(["default",()=>A],27245),e.i(96335);var H=e.i(80622),N=e.i(84933),U=e.i(81706),L=e.i(15127),_=e.i(12396),q=e.i(18420),G=e.i(96861),V=e.i(51480),J=e.i(13740);function K(e){return(0,J.default)("MuiFab",e)}let Q=(0,V.default)("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]);var X=e.i(95262),Y=e.i(32869);let Z=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],ee=(0,X.default)(_.default,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>(0,Y.rootShouldForwardProp)(e)||"classes"===e,overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,t[a.variant],t[`size${(0,q.default)(a.size)}`],"inherit"===a.color&&t.colorInherit,t[(0,q.default)(a.size)],t[a.color]]}})(({theme:e,ownerState:t})=>{var a,r;return(0,N.default)({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:null==(a=(r=e.palette).getContrastText)?void 0:a.call(r,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${Q.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},"small"===t.size&&{width:40,height:40},"medium"===t.size&&{width:48,height:48},"extended"===t.variant&&{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},"extended"===t.variant&&"small"===t.size&&{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"extended"===t.variant&&"medium"===t.size&&{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40},"inherit"===t.color&&{color:"inherit"})},({theme:e,ownerState:t})=>(0,N.default)({},"inherit"!==t.color&&"default"!==t.color&&null!=(e.vars||e).palette[t.color]&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}}),({theme:e})=>({[`&.${Q.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}})),et=a.forwardRef(function(e,a){let r=(0,G.useDefaultProps)({props:e,name:"MuiFab"}),{children:i,className:n,color:o="default",component:l="button",disabled:s=!1,disableFocusRipple:d=!1,focusVisibleClassName:c,size:u="large",variant:h="circular"}=r,f=(0,H.default)(r,Z),p=(0,N.default)({},r,{color:o,component:l,disabled:s,disableFocusRipple:d,size:u,variant:h}),m=(e=>{let{color:t,variant:a,classes:r,size:i}=e,n={root:["root",a,`size${(0,q.default)(i)}`,"inherit"===t?"colorInherit":t]},o=(0,L.default)(n,K,r);return(0,N.default)({},r,o)})(p);return(0,t.jsx)(ee,(0,N.default)({className:(0,U.default)(m.root,n),component:l,disabled:s,focusRipple:!d,focusVisibleClassName:(0,U.default)(m.focusVisible,c),ownerState:p,ref:a},f,{classes:m,children:i}))});e.s(["Fab",0,et],43892)},27796,(e,t,a)=>{"use strict";var r=e.r(91074);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(e.r(64800)),n=e.r(44855);a.default=(0,i.default)((0,n.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z"}),"Chat")}]);